import{d as Ve,a as l,f as v,s as $,c as Fe,b as Ge}from"../chunks/BGsM1btW.js";import{p as Ye,d as I,f as Be,o as Je,u as Ke,g as e,a as Re,b as k,e as Xe,c as s,s as u,$ as Ze,r,h as le,t as S,n as C,i as E}from"../chunks/DEPQPQt8.js";import{i as y}from"../chunks/CVvYbTkW.js";import{e as ne,i as et}from"../chunks/DFPLsyL_.js";import{t as ve,f as tt,a as at}from"../chunks/tw1RdNRP.js";import{h as rt,b as ce,s as J,c as N,r as ue}from"../chunks/BFGHZJqN.js";import{b as pe}from"../chunks/CEtDmXYx.js";import{a as st,s as ot}from"../chunks/DNJl1ib1.js";import{p as it}from"../chunks/CSn65FV0.js";import{a as me}from"../chunks/D9J-t_xT.js";import{I as fe}from"../chunks/Ba9nytLd.js";import{S as dt,C as lt}from"../chunks/B21QHDWq.js";import{C as nt}from"../chunks/CYq1lwc4.js";import{C as vt,a as ct}from"../chunks/BVcDlHOj.js";var ut=v('<div class="glass-card-static p-8 h-36 animate-pulse"></div>'),pt=v('<div class="grid grid-cols-1 md:grid-cols-2 gap-6"></div>'),mt=v('<div class="flex items-center gap-1 text-[10px] font-black uppercase text-gov-red"><!> Expired</div>'),ft=v('<div class="flex items-center gap-1 text-[10px] font-black uppercase text-gov-gold-dark"><!> Upcoming</div>'),_t=v('<div class="flex items-center gap-1 text-[10px] font-black uppercase text-gov-green"><!> Active</div>'),bt=v('<div class="flex items-center gap-1 text-[10px] font-black uppercase text-text-muted"><!> Admin View</div>'),gt=v('<button class="p-2.5 rounded-xl bg-gov-blue/5 text-gov-blue hover:bg-gov-blue hover:text-white active:scale-95 transition-all shadow-sm flex items-center justify-center"><!></button>'),xt=v('<input type="date" class="w-full px-4 py-3.5 bg-white/50 border border-gray-100 rounded-2xl focus:ring-2 focus:ring-gov-blue/20 focus:border-gov-blue outline-none text-sm font-semibold transition-all"/>'),ht=v('<p class="w-full px-4 py-3.5 bg-white/30 border border-gray-100 rounded-2xl text-sm font-semibold text-text-primary"> </p>'),yt=v('<input type="text" placeholder="e.g. DLL Submission..." class="w-full px-4 py-3.5 bg-white/50 border border-gray-100 rounded-2xl focus:ring-2 focus:ring-gov-blue/20 focus:border-gov-blue outline-none text-sm font-medium placeholder:text-gray-300 transition-all"/>'),wt=v('<p class="w-full px-4 py-3.5 bg-white/30 border border-gray-100 rounded-2xl text-sm font-medium text-text-secondary"> </p>'),kt=v('<div class="glass-card-static p-8 group relative overflow-hidden"><div class="flex items-center justify-between mb-8"><div class="flex items-center gap-4"><div class="w-14 h-14 rounded-2xl bg-gov-blue text-white flex items-center justify-center font-black text-xl shadow-lg shadow-gov-blue/20"> </div> <div><h3 class="font-black text-text-primary text-lg"> </h3> <div class="flex items-center gap-1.5 mt-1"><!></div></div></div> <!></div> <div class="space-y-4"><div class="relative"><label class="absolute -top-2 left-3 px-1 bg-white text-[10px] font-bold text-gov-blue uppercase tracking-widest z-10">Due Date</label> <!></div> <div class="relative"><label class="absolute -top-2 left-3 px-1 bg-white text-[10px] font-bold text-text-muted uppercase tracking-widest z-10">Notes / Purpose</label> <!></div></div></div>'),St=v(`<div class="mt-12 p-8 bg-surface border border-border-subtle rounded-[2.5rem] shadow-sm"><div class="flex items-start gap-4"><div class="p-2.5 rounded-xl bg-gov-blue/10 text-gov-blue group-hover:bg-gov-blue group-hover:text-white transition-all"><!></div> <div><h4 class="font-bold text-text-primary text-lg mb-1">Operational Guidelines</h4> <p class="text-sm text-text-secondary leading-relaxed">Each week is saved individually by clicking the <span class="inline-flex items-center justify-center px-2 py-0.5 rounded bg-gov-blue/10 text-gov-blue font-bold text-[10px] uppercase">Save</span> icon. Deadlines are set to <strong>11:59 PM</strong> of the selected date. Submissions
                            after this will be marked as "Late" or "Non-compliant"
                            automatically.</p></div></div></div>`),Ct=v(`<div class="mt-12 p-8 bg-surface border border-border-subtle rounded-[2.5rem] shadow-sm"><div class="flex items-start gap-4"><div class="p-2.5 rounded-xl bg-gov-green/10 text-gov-green"><!></div> <div><h4 class="font-bold text-text-primary text-lg mb-1">Submission Protocols</h4> <p class="text-sm text-text-secondary leading-relaxed">Submit your documents before the deadline to be
                            marked as <strong>Compliant</strong>. Submissions after the
                            deadline are marked as <strong>Late</strong> or <strong>Non-compliant</strong>. Contact your
                            supervisor if you need deadline adjustments.</p></div></div></div>`),zt=v('<div class="grid grid-cols-1 md:grid-cols-2 gap-8"></div> <!>',1),Dt=v(`<div class="max-w-4xl mx-auto"><div class="mb-10 flex flex-col md:flex-row md:items-end justify-between gap-6"><div><h1 class="text-3xl font-black text-text-primary tracking-tight">Academic Calendar</h1> <p class="text-base text-text-secondary mt-1 font-medium max-w-lg">Manage submission deadlines and institutional timeline for the
                current school year.</p></div> <div class="flex items-center gap-3 p-1.5 bg-surface-muted rounded-2xl border border-border-subtle shadow-sm"><select class="px-4 py-2 bg-transparent border-none rounded-xl focus:ring-0 outline-none text-sm font-bold text-gov-blue cursor-pointer"><option>2024-2025</option><option>2025-2026</option></select> <div class="w-px h-4 bg-border-subtle"></div> <select class="px-4 py-2 bg-transparent border-none rounded-xl focus:ring-0 outline-none text-sm font-bold text-gov-blue cursor-pointer"><option>1st Quarter</option><option>2nd Quarter</option><option>3rd Quarter</option><option>4th Quarter</option></select></div></div> <!></div>`);function Ot(_e,be){Ye(be,!0);const z=()=>ot(it,"$profile",ge),[ge,xe]=st();let D=I("2025-2026"),W=I(1),K=I(Be([])),R=I(!0),x=I(null);const he=E(()=>z()?.role==="Teacher"),w=E(()=>!e(he));Je(async()=>{if(z()?.district_id)k(x,z().district_id,!0);else if(z()?.school_id){const{data:t}=await J.from("schools").select("district_id").eq("id",z().school_id).single();k(x,t?.district_id||null,!0)}e(x)&&await X(),k(R,!1)});async function X(){if(!e(x))return;const{data:t,error:d}=await J.from("academic_calendar").select("*").eq("school_year",e(D)).eq("quarter",e(W)).eq("district_id",e(x)).order("week_number",{ascending:!0});if(d){console.error("[v0] Error loading calendar:",d);return}const n=t||[];k(K,Array.from({length:10},(_,q)=>{const j=q+1,c=n.find(o=>o.week_number===j);return{id:c?.id,week_number:j,deadline_date:c?.deadline_date?c.deadline_date.split("T")[0]:"",description:c?.description||`Week ${j} Submission`}}),!0)}async function ye(t){if(!e(w)||!e(x)||!t.deadline_date)return;const d={...t.id?{id:t.id}:{},school_year:e(D),quarter:e(W),week_number:t.week_number,deadline_date:new Date(t.deadline_date).toISOString(),description:t.description,district_id:e(x)},{data:n,error:_}=await J.from("academic_calendar").upsert(d).select();_?(console.error("[v0] Save error:",_),me("error",`Failed to save Week ${t.week_number}: ${_.message}`)):(me("success",`Week ${t.week_number} updated!`),n&&n[0]&&(t.id=n[0].id))}function we(t){if(!t)return!1;const d=new Date(t);return d.setHours(23,59,59,999),new Date>d}function ke(t){if(!t)return!1;const d=new Date(t);d.setHours(0,0,0,0);const n=new Date;n.setHours(0,0,0,0);const _=new Date(n.getTime()+4320*60*1e3);return _.setHours(23,59,59,999),d>=n&&d<=_}Ke(()=>{(e(D)||e(W))&&X()});var H=Dt();rt("140v80w",t=>{Xe(()=>{Ze.title="Academic Calendar — Smart E-VISION"})});var L=s(H),Z=u(s(L),2),T=s(Z),P=s(T);P.value=P.__value="2024-2025";var ee=u(P);ee.value=ee.__value="2025-2026",r(T);var Q=u(T,4),M=s(Q);M.value=M.__value=1;var O=u(M);O.value=O.__value=2;var U=u(O);U.value=U.__value=3;var te=u(U);te.value=te.__value=4,r(Q),r(Z),r(L);var Se=u(L,2);{var Ce=t=>{var d=pt();ne(d,20,()=>Array(6),et,(n,_)=>{var q=ut();l(n,q)}),r(d),l(t,d)},ze=t=>{var d=zt(),n=le(d);ne(n,23,()=>e(K),c=>c.week_number,(c,o,m)=>{var b=kt(),h=s(b),V=s(h),F=s(V),De=s(F,!0);r(F);var ae=u(F,2),G=s(ae),We=s(G);r(G);var re=u(G,2),qe=s(re);{var je=i=>{var a=Fe(),p=le(a);{var B=g=>{var f=mt(),A=s(f);nt(A,{size:10}),C(),r(f),l(g,f)},Qe=E(()=>we(e(o).deadline_date)),Me=g=>{var f=ft(),A=s(f);vt(A,{size:10}),C(),r(f),l(g,f)},Oe=E(()=>ke(e(o).deadline_date)),Ue=g=>{var f=_t(),A=s(f);ct(A,{size:10}),C(),r(f),l(g,f)};y(p,g=>{e(Qe)?g(B):e(Oe)?g(Me,1):g(Ue,!1)})}l(i,a)},Ae=i=>{var a=bt(),p=s(a);fe(p,{size:10}),C(),r(a),l(i,a)};y(qe,i=>{!e(w)&&e(o).deadline_date?i(je):i(Ae,!1)})}r(re),r(ae),r(V);var Ie=u(V,2);{var Ne=i=>{var a=gt(),p=s(a);dt(p,{size:20,strokeWidth:2.5}),r(a),S(()=>N(a,"title",`Save Week ${e(o).week_number??""}`)),Ge("click",a,()=>ye(e(o))),l(i,a)};y(Ie,i=>{e(w)&&i(Ne)})}r(h);var se=u(h,2),Y=s(se),oe=s(Y),Te=u(oe,2);{var $e=i=>{var a=xt();ue(a),S(()=>N(a,"id",`date-${e(m)??""}`)),pe(a,()=>e(o).deadline_date,p=>e(o).deadline_date=p),l(i,a)},Ee=i=>{var a=ht(),p=s(a,!0);r(a),S(B=>$(p,B),[()=>e(o).deadline_date?new Date(e(o).deadline_date+"T00:00:00").toLocaleDateString("en-PH",{weekday:"long",month:"long",day:"numeric",year:"numeric"}):"Not set"]),l(i,a)};y(Te,i=>{e(w)?i($e):i(Ee,!1)})}r(Y);var ie=u(Y,2),de=s(ie),He=u(de,2);{var Le=i=>{var a=yt();ue(a),S(()=>N(a,"id",`desc-${e(m)??""}`)),pe(a,()=>e(o).description,p=>e(o).description=p),l(i,a)},Pe=i=>{var a=wt(),p=s(a,!0);r(a),S(()=>$(p,e(o).description||"—")),l(i,a)};y(He,i=>{e(w)?i(Le):i(Pe,!1)})}r(ie),r(se),r(b),S(()=>{$(De,e(o).week_number),$(We,`Week ${e(o).week_number??""}`),N(oe,"for",`date-${e(m)??""}`),N(de,"for",`desc-${e(m)??""}`)}),ve(1,b,()=>tt,()=>({y:20,delay:e(m)*50})),l(c,b)}),r(n);var _=u(n,2);{var q=c=>{var o=St(),m=s(o),b=s(m),h=s(b);fe(h,{size:24}),r(b),C(2),r(m),r(o),l(c,o)},j=c=>{var o=Ct(),m=s(o),b=s(m),h=s(b);lt(h,{size:24}),r(b),C(2),r(m),r(o),l(c,o)};y(_,c=>{e(w)?c(q):c(j,!1)})}ve(1,n,()=>at),l(t,d)};y(Se,t=>{e(R)?t(Ce):t(ze,!1)})}r(H),ce(T,()=>e(D),t=>k(D,t)),ce(Q,()=>e(W),t=>k(W,t)),l(_e,H),Re(),xe()}Ve(["click"]);export{Ot as component};
