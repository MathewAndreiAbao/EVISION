import{d as re,c as oe,a as u,s as R,f as b,b as N,t as pe,e as ne}from"../chunks/BGsM1btW.js";import{p as ee,o as ce,b as o,h as te,g as e,a as ae,d as A,c as a,r as t,s as d,t as G,aJ as le,i as B,u as ye,e as Se,$ as ke}from"../chunks/DEPQPQt8.js";import{s as $e}from"../chunks/COHKNyhF.js";import{i as I}from"../chunks/CVvYbTkW.js";import{c as me,a as de,h as Ie}from"../chunks/BFGHZJqN.js";import{s as F,a as ve}from"../chunks/DNJl1ib1.js";import{e as he,i as xe}from"../chunks/DFPLsyL_.js";import{c as ge}from"../chunks/BvMhsobz.js";import{p as Te}from"../chunks/5_ZOgByb.js";import{p as Le,a as Ne,u as Me}from"../chunks/CSn65FV0.js";import{t as be,f as Ee,a as Ae}from"../chunks/tw1RdNRP.js";import{pendingSyncCount as De,processQueue as Ce}from"../chunks/B4SNXARi.js";import{C as je,L as ze,a as Oe,b as We,A as Pe,B as He,M as Ue,S as Ve,c as Xe}from"../chunks/DXadS_Hu.js";import{S as Be}from"../chunks/ChEqcw_R.js";import{T as Re}from"../chunks/lxx4mEY1.js";import{X as Ge}from"../chunks/DZbIYM4O.js";import{g as Je}from"../chunks/DHcjO8WO.js";var Ke=b('<span class="px-2 py-0.5 bg-gov-blue/10 text-gov-blue text-[12px] font-bold rounded-full"> </span>'),Qe=b(`<p class="text-[12px] text-text-muted leading-tight">You're offline. Uploads will be saved and synced
                    automatically when back online.</p>`),Ye=b('<button class="w-full py-2.5 bg-gov-blue text-white rounded-xl text-[14px] font-bold hover:bg-gov-blue-dark transition-all disabled:opacity-50 flex items-center justify-center gap-2"><!></button>'),Ze=b('<div class="mt-auto pt-6 border-t border-gray-100 px-2"><div class="glass-card-static p-4 space-y-3"><div class="flex items-center justify-between"><span class="text-[14px] font-medium text-text-primary flex items-center gap-2"> </span> <!></div> <!></div></div>');function qe(D,M){ee(M,!0);const s=()=>F(De,"$pendingSyncCount",m),[m,y]=ve();let f=A(!0),h=A(!1);ce(()=>{o(f,navigator.onLine,!0),window.addEventListener("online",()=>o(f,!0)),window.addEventListener("offline",()=>o(f,!1))});async function x(){if(!(e(h)||!e(f))){o(h,!0);try{await Ce(!0)}finally{o(h,!1)}}}var T=oe(),_=te(T);{var i=c=>{var v=Ze(),p=a(v),S=a(p),k=a(S),L=a(k,!0);t(k);var z=d(k,2);{var O=w=>{var n=Ke(),g=a(n);t(n),G(()=>R(g,`${s()??""} pending`)),u(w,n)};I(z,w=>{s()>0&&w(O)})}t(S);var K=d(S,2);{var Q=w=>{var n=Qe();u(w,n)},Y=w=>{var n=Ye(),g=a(n);{var W=P=>{var Z=pe("Syncing...");u(P,Z)},J=P=>{var Z=pe("Sync Now");u(P,Z)};I(g,P=>{e(h)?P(W):P(J,!1)})}t(n),G(()=>n.disabled=e(h)),N("click",n,x),u(w,n)};I(K,w=>{e(f)?s()>0&&w(Y,1):w(Q)})}t(p),t(v),G(()=>R(L,e(f)?"Online":"Offline")),be(1,v,()=>Ee,()=>({y:20,duration:400})),be(2,v,()=>Ae),u(c,v)};I(_,c=>{(s()>0||!e(f))&&c(i)})}u(D,T),ae(),y()}re(["click"]);var Fe=b('<div class="lg:hidden fixed inset-0 bg-slate-900/60 backdrop-blur-md z-40 transition-opacity duration-500" role="presentation"></div>'),et=b('<li><a><div class="flex items-center gap-3"><!> <span> </span></div> <!></a></li>'),tt=b('<div class="p-6 border-t border-border-subtle bg-surface-muted/30"><div class="flex items-center gap-4 mb-4"><div class="w-11 h-11 rounded-2xl bg-gov-blue/10 flex items-center justify-center text-sm font-black text-gov-blue border-2 border-white shadow-sm"> </div> <div class="flex-1 min-w-0"><p class="text-sm font-black text-text-primary truncate"> </p> <p class="text-[10px] text-text-muted font-bold uppercase tracking-wider truncate"> </p></div></div> <!></div>'),at=b('<a><!> <span class="text-[9px] font-black uppercase tracking-tighter"> </span></a>'),rt=b('<button class="lg:hidden fixed top-4 left-4 z-50 w-12 h-12 flex items-center justify-center rounded-2xl bg-gov-blue text-white shadow-lg active:scale-95 transition-all" aria-label="Toggle menu"><!></button> <!> <aside><a href="/dashboard" class="block p-8 mb-4 no-underline group"><div class="flex items-center gap-4"><div class="w-12 h-12 rounded-2xl gov-header-gradient flex items-center justify-center text-white text-2xl font-black shadow-lg shadow-gov-blue/20 group-hover:scale-105 transition-transform">E</div> <div><h1 class="text-lg font-black text-text-primary leading-none tracking-tighter">Smart E-VISION</h1> <p class="text-[10px] text-text-muted font-bold uppercase tracking-[0.2em] mt-1">System Hub</p></div></div></a> <nav class="flex-1 px-4 overflow-y-auto"><ul class="space-y-2"></ul></nav> <!></aside> <nav class="lg:hidden fixed bottom-6 left-6 right-6 z-40 glass-card-static border border-white/40 shadow-2xl"><div class="flex items-center justify-around p-2"></div></nav>',1);function ot(D,M){ee(M,!0);const s=()=>F(Le,"$profile",y),m=()=>F(Te,"$page",y),[y,f]=ve(),h=[{href:"/dashboard",label:"Dashboard",icon:ze,mobileNav:!0,roles:["Teacher","School Head","Master Teacher","District Supervisor"]},{href:"/dashboard/calendar",label:"Calendar",icon:Oe,mobileNav:!0,roles:["Teacher","School Head","Master Teacher","District Supervisor"]},{href:"/dashboard/upload",label:"Upload",icon:We,mobileNav:!0,roles:["Teacher"]},{href:"/dashboard/archive",label:"Archive",icon:Pe,mobileNav:!0,roles:["Teacher","School Head","Master Teacher","District Supervisor"]},{href:"/dashboard/load",label:"Teaching Load",icon:He,roles:["Teacher"]},{href:"/dashboard/monitoring/school",label:"School Monitor",icon:Be,mobileNav:!0,roles:["School Head","Master Teacher"]},{href:"/dashboard/monitoring/district",label:"District Monitor",icon:Ue,mobileNav:!0,roles:["District Supervisor"]},{href:"/dashboard/analytics",label:"Analytics",icon:Re,roles:["School Head","Master Teacher","District Supervisor"]},{href:"/dashboard/settings",label:"Settings",icon:Ve,roles:["Teacher","School Head","Master Teacher","District Supervisor"]}];let x=A(!1);const T=B(()=>h.filter(r=>{const l=s()?.role?.toLowerCase()||"";return r.roles.some(C=>l.includes(C.toLowerCase().trim()))})),_=B(()=>e(T).filter(r=>r.mobileNav).slice(0,5));function i(r){const l=m().url.pathname;return r==="/dashboard"?l==="/dashboard":l.startsWith(r)}let c=0,v=0,p=!1;function S(r){c=r.touches[0].clientX,c<30&&(p=!0)}function k(r){p&&(v=r.touches[0].clientX)}function L(){if(!p)return;v-c>80&&o(x,!0),p=!1}var z=rt();ne("touchstart",le,S,void 0,!0),ne("touchmove",le,k,void 0,!0),ne("touchend",le,L);var O=te(z),K=a(O);{var Q=r=>{Ge(r,{size:24})},Y=r=>{Xe(r,{size:24})};I(K,r=>{e(x)?r(Q):r(Y,!1)})}t(O);var w=d(O,2);{var n=r=>{var l=Fe();N("click",l,()=>o(x,!1)),u(r,l)};I(w,r=>{e(x)&&r(n)})}var g=d(w,2),W=d(a(g),2),J=a(W);he(J,21,()=>e(T),xe,(r,l)=>{const C=B(()=>e(l).icon);var $=et(),E=a($),j=a(E),H=a(j);{let X=B(()=>i(e(l).href)?2.5:2);ge(H,()=>e(C),(_e,we)=>{we(_e,{size:20,get strokeWidth(){return e(X)}})})}var U=d(H,2),V=a(U,!0);t(U),t(j);var q=d(j,2);{var se=X=>{je(X,{size:16})},ie=B(()=>i(e(l).href));I(q,X=>{e(ie)&&X(se)})}t(E),t($),G(X=>{me(E,"href",e(l).href),de(E,1,`flex items-center justify-between px-4 py-3 rounded-xl text-sm font-bold transition-all duration-200 group
							${X??""}`),R(V,e(l).label)},[()=>i(e(l).href)?"bg-gov-blue text-white shadow-lg shadow-gov-blue/10":"text-text-secondary hover:bg-surface-muted hover:text-gov-blue"]),N("click",E,()=>o(x,!1)),u(r,$)}),t(J),t(W);var P=d(W,2);{var Z=r=>{var l=tt(),C=a(l),$=a(C),E=a($,!0);t($);var j=d($,2),H=a(j),U=a(H,!0);t(H);var V=d(H,2),q=a(V,!0);t(V),t(j),t(C);var se=d(C,2);qe(se,{}),t(l),G(ie=>{R(E,ie),R(U,s().full_name),R(q,s().role)},[()=>s().full_name?.charAt(0)||"?"]),u(r,l)};I(P,r=>{s()&&r(Z)})}t(g);var ue=d(g,2),fe=a(ue);he(fe,21,()=>e(_),xe,(r,l)=>{const C=B(()=>e(l).icon);var $=at(),E=a($);{let U=B(()=>i(e(l).href)?2.5:2);ge(E,()=>e(C),(V,q)=>{q(V,{size:22,get strokeWidth(){return e(U)}})})}var j=d(E,2),H=a(j,!0);t(j),t($),G((U,V)=>{me($,"href",e(l).href),de($,1,`flex flex-col items-center gap-1 p-2 rounded-xl transition-all duration-300
					${U??""}`),R(H,V)},[()=>i(e(l).href)?"text-gov-blue bg-gov-blue/10 scale-110":"text-text-muted hover:text-gov-blue",()=>e(l).label.split(" ")[0]]),N("click",$,()=>o(x,!1)),u(r,$)}),t(fe),t(ue),G(()=>de(g,1,`fixed top-0 left-0 h-full w-72 z-50 flex flex-col bg-white border-r border-border-subtle shadow-xl transition-transform duration-500 ease-pop
		${e(x)?"translate-x-0":"-translate-x-full"} lg:translate-x-0`)),N("click",O,()=>o(x,!e(x))),u(D,z),ae(),f()}re(["click"]);var st=b(`<p class="text-xs text-text-muted mt-1 leading-relaxed">Tap <strong>Share</strong> (□↑) then <strong>"Add to Home Screen"</strong> for the full app
                            experience.</p>`),it=b(`<p class="text-xs text-text-muted mt-1 leading-relaxed">Install as an app for faster access, offline
                            support, and push notifications.</p>`),nt=b('<div class="flex gap-2 mt-4"><button class="flex-1 py-2.5 px-4 bg-gradient-to-r from-gov-blue to-gov-blue-dark text-white rounded-xl font-semibold text-sm hover:shadow-lg transition-all hover:-translate-y-0.5 cursor-pointer">Install App</button> <button class="py-2.5 px-4 text-text-muted hover:text-text-primary text-sm font-medium transition-colors cursor-pointer">Not now</button></div>'),lt=b('<div class="fixed bottom-24 lg:bottom-6 left-4 right-4 lg:left-auto lg:right-6 lg:w-96 z-50 animate-slide-up"><div class="glass-card p-5 border-l-4 border-gov-blue shadow-elevated"><div class="flex items-start gap-3"><div class="w-12 h-12 rounded-xl bg-gradient-to-br from-gov-blue to-gov-blue-dark flex items-center justify-center text-white text-xl font-bold shrink-0">E</div> <div class="flex-1 min-w-0"><h3 class="font-bold text-text-primary text-sm">Install Smart E-VISION</h3> <!></div> <button class="text-text-muted hover:text-text-primary transition-colors text-lg leading-none p-1 cursor-pointer" aria-label="Dismiss">✕</button></div> <!></div></div>');function dt(D,M){ee(M,!0);let s=A(null),m=A(!1),y=A(!1),f=A(!1),h=A(!1);ce(()=>{if(window.matchMedia("(display-mode: standalone)").matches){o(f,!0);return}const v=navigator.userAgent;o(y,/iPad|iPhone|iPod/.test(v)||navigator.platform==="MacIntel"&&navigator.maxTouchPoints>1,!0),window.addEventListener("beforeinstallprompt",p=>{p.preventDefault(),o(s,p,!0),setTimeout(()=>{e(h)||o(m,!0)},3e3)}),window.addEventListener("appinstalled",()=>{o(f,!0),o(m,!1),o(s,null)}),e(y)&&!e(f)&&setTimeout(()=>{e(h)||o(m,!0)},5e3)});async function x(){if(!e(s))return;e(s).prompt();const{outcome:v}=await e(s).userChoice;v==="accepted"&&o(f,!0),o(s,null),o(m,!1)}function T(){o(m,!1),o(h,!0)}var _=oe(),i=te(_);{var c=v=>{var p=lt(),S=a(p),k=a(S),L=d(a(k),2),z=d(a(L),2);{var O=n=>{var g=st();u(n,g)},K=n=>{var g=it();u(n,g)};I(z,n=>{e(y)?n(O):n(K,!1)})}t(L);var Q=d(L,2);t(k);var Y=d(k,2);{var w=n=>{var g=nt(),W=a(g),J=d(W,2);t(g),N("click",W,x),N("click",J,T),u(n,g)};I(Y,n=>{e(y)||n(w)})}t(S),t(p),N("click",Q,T),u(v,p)};I(i,v=>{e(m)&&!e(f)&&!e(h)&&v(c)})}u(D,_),ae()}re(["click"]);var ct=b('<div class="fixed top-4 left-4 right-4 lg:left-auto lg:right-6 lg:w-96 z-[60] animate-slide-up"><div class="glass-card p-4 border-l-4 border-gov-green shadow-elevated"><div class="flex items-center gap-3"><div class="w-10 h-10 rounded-xl bg-gov-green flex items-center justify-center text-white text-[10px] font-black shrink-0">NEW</div> <div class="flex-1 min-w-0"><h3 class="font-bold text-text-primary text-sm">Update Available</h3> <p class="text-xs text-text-muted mt-0.5">A new version of Smart E-VISION is ready.</p></div> <button class="text-text-muted hover:text-text-primary text-sm p-1 cursor-pointer font-bold" aria-label="Dismiss">CLOSE</button></div> <div class="flex gap-2 mt-3"><button class="flex-1 py-2 px-4 bg-gov-green text-white rounded-xl font-semibold text-sm hover:shadow-lg transition-all cursor-pointer">Refresh Now</button> <button class="py-2 px-4 text-text-muted text-sm font-medium cursor-pointer">Later</button></div></div></div>');function vt(D,M){ee(M,!0);let s=A(!1),m=A(null);ce(()=>{if(!("serviceWorker"in navigator))return;navigator.serviceWorker.ready.then(i=>{i.waiting&&(o(m,i.waiting,!0),o(s,!0)),i.addEventListener("updatefound",()=>{const c=i.installing;c&&c.addEventListener("statechange",()=>{c.state==="installed"&&navigator.serviceWorker.controller&&(o(m,c,!0),o(s,!0))})})});let _=!1;navigator.serviceWorker.addEventListener("controllerchange",()=>{_||(_=!0,window.location.reload())})});function y(){e(m)&&e(m).postMessage({type:"SKIP_WAITING"}),o(s,!1)}function f(){o(s,!1)}var h=oe(),x=te(h);{var T=_=>{var i=ct(),c=a(i),v=a(c),p=d(a(v),4);t(v);var S=d(v,2),k=a(S),L=d(k,2);t(S),t(c),t(i),N("click",p,f),N("click",k,y),N("click",L,f),u(_,i)};I(x,_=>{e(s)&&_(T)})}u(D,h),ae()}re(["click"]);var ut=b('<div class="min-h-screen gradient-mesh flex items-center justify-center"><div class="text-center animate-fade-in"><div class="w-16 h-16 mx-auto rounded-2xl gov-header-gradient flex items-center justify-center text-white text-3xl font-bold shadow-elevated mb-4 animate-pulse-glow">V</div> <p class="text-lg text-text-secondary font-medium">INITIALIZING...</p></div></div>'),ft=b('<div class="min-h-screen bg-surface"><!> <main class="lg:ml-72 min-h-screen"><div class="p-4 pt-16 lg:pt-8 lg:p-8 pb-24 lg:pb-8 max-w-7xl mx-auto"><!></div></main> <!> <!></div>');function Et(D,M){ee(M,!0);const s=()=>F(Ne,"$authLoading",y),m=()=>F(Me,"$user",y),[y,f]=ve();ye(()=>{!s()&&!m()&&Je("/auth/login")});var h=oe();Ie("2agd5u",i=>{Se(()=>{ke.title="Smart E-VISION — DASHBOARD"})});var x=te(h);{var T=i=>{var c=ut();u(i,c)},_=i=>{var c=ft(),v=a(c);ot(v,{});var p=d(v,2),S=a(p),k=a(S);$e(k,()=>M.children),t(S),t(p);var L=d(p,2);dt(L,{});var z=d(L,2);vt(z,{}),t(c),u(i,c)};I(x,i=>{s()?i(T):m()&&i(_,1)})}u(D,h),ae(),f()}export{Et as component};
