const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["../chunks/CDQxWuWv.js","../chunks/BluUn2SV.js","../chunks/TDtrdbi3.js","../chunks/1R2GlNHj.js","../chunks/B5CaCgBQ.js","../chunks/PPVm8Dsz.js","../chunks/B4SNXARi.js","../chunks/DEPQPQt8.js","../chunks/BFGHZJqN.js","../chunks/BGsM1btW.js","../chunks/D9J-t_xT.js"])))=>i.map(i=>d[i]);
import{r as Oe,S as be,P as _e,A as ea,b as aa,d as ta,e as ra,f as sa,h as oa,i as na,B as ia,C as da,j as la,k as ca,l as ua,m as ga,n as pa,o as ma,D as fa,E as va,p as ba,F as xa,q as ha,s as _a,t as ya,I as wa,u as Pa,v as Da,w as Fa,x as Sa,y as Ea,z as Ta,J as Aa,L as ka,G as Ia,M as La,H as Ca,K as Ra,N as Oa,O as Ba,Q as Na,R as Ua,T as Ma,U as ja,V as Ha,W as qa,X as za,Y as $a,Z as Va,_ as Wa,$ as Ga,a0 as Qa,a1 as Ka,a2 as Ja,a3 as Ya,a4 as Za,a5 as Xa,a6 as et,a7 as at,a8 as tt,a9 as rt,aa as st,ab as ot,ac as nt,ad as it,ae as dt,af as lt,ag as ct,ah as ut,ai as gt,aj as pt,ak as mt,al as ft,am as vt,an as bt,ao as xt,ap as ht,aq as _t,ar as yt,as as wt,at as Pt,au as Dt,av as Ft,aw as St,ax as Et,ay as Tt,az as At,aA as kt,aB as It,aC as Lt,aD as Ct,aE as Rt,aF as Ot,aG as Bt,aH as Nt,aI as Ut,aJ as Mt,aK as jt,aL as Ht,aM as qt,aN as zt,aO as $t,aP as Vt,aQ as Wt,aR as Gt,aS as Qt,aT as Kt,aU as Jt,aV as Yt,aW as Zt,aX as Xt,aY as er,aZ as ar,a_ as tr,a$ as rr,b0 as sr,b1 as or,b2 as nr,b3 as ir,b4 as dr,b5 as lr,b6 as cr,b7 as ur,b8 as gr,b9 as pr,ba as mr,bb as fr,bc as vr,bd as br,be as xr,bf as hr,bg as _r,bh as yr,bi as wr,bj as Pr,bk as Dr,bl as Fr,bm as Sr,bn as Er,bo as Tr,bp as Ar,bq as kr,br as Ir,bs as Lr,bt as Cr,bu as Rr,bv as Or,bw as Br,bx as Nr,by as Ur,bz as Mr,bA as jr,bB as Hr,bC as qr,bD as zr,bE as $r,bF as Vr,bG as Wr,bH as Gr,bI as Qr,bJ as Kr,bK as Jr,bL as Yr,bM as Zr,bN as Xr,bO as es,bP as as,bQ as ts,bR as rs,bS as ss,bT as os,bU as ns,bV as is,bW as ds,bX as ls,bY as cs,bZ as us,b_ as gs,b$ as ps,c0 as ms,c1 as fs,c2 as vs,c3 as bs,c4 as xs,c5 as hs,c6 as _s,c7 as ys,c8 as ws,c9 as Ps,ca as Ds,cb as Fs,cc as Ss,cd as Es,ce as Ts,cf as As,cg as ks,ch as Is,ci as Ls,cj as Cs,ck as Rs,cl as Os,cm as Bs,cn as Ns,co as Us,cp as Ms,cq as js,cr as Hs,cs as qs,ct as zs,cu as $s,cv as Vs,cw as Ws,cx as Gs,cy as Qs,cz as Ks,cA as Js,cB as Ys,cC as Zs,cD as Xs,cE as eo,cF as ao,cG as to,cH as ro,cI as so,cJ as oo,cK as no,cL as io,cM as lo,cN as co,cO as uo,cP as go,cQ as po,cR as mo,cS as fo,cT as vo,cU as bo,cV as xo,cW as ho,cX as _o,cY as yo,cZ as wo,c_ as Po,c$ as Do,d0 as Fo,d1 as So,d2 as Eo,d3 as To,d4 as Ao,d5 as ko,d6 as Io,d7 as Lo,d8 as Co,d9 as Ro,da as Oo,db as Bo,dc as No,dd as Uo,de as Mo,df as jo,dg as Ho,dh as qo,di as zo,dj as $o,dk as Vo,dl as Wo,dm as Go,dn as Qo,dp as Ko,dq as Jo,dr as Yo,ds as Zo,dt as Xo,du as en,dv as an,dw as tn,dx as rn,dy as sn,dz as on,dA as nn,dB as dn,dC as ln,dD as cn,dE as un,dF as gn,dG as pn,dH as mn,dI as fn,dJ as vn,dK as bn,dL as xn}from"../chunks/BluUn2SV.js";import{_ as K}from"../chunks/PPVm8Dsz.js";import{d as Be,e as fe,b as oe,a as P,f as E,s as B,t as xe}from"../chunks/BGsM1btW.js";import{p as Ne,t as j,a as Ue,c as s,b as x,d as U,s as i,g as e,r as t,n as Me,h as hn,i as _n,f as ke,u as Ie,o as yn,e as wn,$ as Pn}from"../chunks/DEPQPQt8.js";import{i as H}from"../chunks/CVvYbTkW.js";import{e as he,i as je}from"../chunks/DFPLsyL_.js";import{a as le,c as Dn,e as Fn,f as Sn,s as Q,h as En,r as Tn,b as Le}from"../chunks/BFGHZJqN.js";import{b as An}from"../chunks/CEtDmXYx.js";import{s as kn,a as In}from"../chunks/DNJl1ib1.js";import{b as Ln}from"../chunks/REG38ZGk.js";import{p as ce}from"../chunks/CYSWjtEC.js";import{enqueue as Cn,getQueueSize as ve}from"../chunks/B4SNXARi.js";import{p as Rn}from"../chunks/CSn65FV0.js";import{a as de}from"../chunks/D9J-t_xT.js";const On=Object.freeze(Object.defineProperty({__proto__:null,get AFRelationship(){return ea},get AcroButtonFlags(){return aa},get AcroChoiceFlags(){return ta},get AcroFieldFlags(){return ra},get AcroTextFlags(){return sa},get AnnotationFlags(){return oa},AppearanceCharacteristics:na,get BlendMode(){return ia},Cache:da,CharCodes:la,get ColorTypes(){return ca},CombedTextLayoutError:ua,CorruptPageTreeError:ga,CustomFontEmbedder:pa,CustomFontSubsetEmbedder:ma,get Duplex(){return fa},EncryptedPDFError:va,ExceededMaxLengthError:ba,FieldAlreadyExistsError:xa,FileEmbedder:ha,FontkitNotRegisteredError:_a,ForeignPageError:ya,get ImageAlignment(){return wa},IndexOutOfBoundsError:Pa,InvalidAcroFieldValueError:Da,InvalidFieldNamePartError:Fa,InvalidMaxLengthError:Sa,InvalidPDFDateStringError:Ea,InvalidTargetIndexError:Ta,JpegEmbedder:Aa,get LineCapStyle(){return ka},get LineJoinStyle(){return Ia},MethodNotImplementedError:La,MissingDAEntryError:Ca,MissingKeywordError:Ra,MissingPDFHeaderError:Oa,MissingPageContentsEmbeddingError:Ba,MissingTfOperatorError:Na,MultiSelectValueError:Ua,NextByteAssertionError:Ma,NoSuchFieldError:ja,get NonFullScreenPageMode(){return Ha},NumberParsingError:qa,PDFAcroButton:za,PDFAcroCheckBox:$a,PDFAcroChoice:Va,PDFAcroComboBox:Wa,PDFAcroField:Ga,PDFAcroForm:Qa,PDFAcroListBox:Ka,PDFAcroNonTerminal:Ja,PDFAcroPushButton:Ya,PDFAcroRadioButton:Za,PDFAcroSignature:Xa,PDFAcroTerminal:et,PDFAcroText:at,PDFAnnotation:tt,PDFArray:rt,PDFArrayIsNotRectangleError:st,PDFBool:ot,PDFButton:nt,PDFCatalog:it,PDFCheckBox:dt,PDFContentStream:lt,PDFContext:ct,PDFCrossRefSection:ut,PDFCrossRefStream:gt,PDFDict:pt,PDFDocument:_e,PDFDropdown:mt,PDFEmbeddedPage:ft,PDFField:vt,PDFFlateStream:bt,PDFFont:xt,PDFForm:ht,PDFHeader:_t,PDFHexString:yt,PDFImage:wt,PDFInvalidObject:Pt,PDFInvalidObjectParsingError:Dt,PDFJavaScript:Ft,PDFName:St,PDFNull:Et,PDFNumber:Tt,PDFObject:At,PDFObjectCopier:kt,PDFObjectParser:It,PDFObjectParsingError:Lt,PDFObjectStream:Ct,PDFObjectStreamParser:Rt,PDFOperator:Ot,PDFOperatorNames:Bt,PDFOptionList:Nt,PDFPage:Ut,PDFPageEmbedder:Mt,PDFPageLeaf:jt,PDFPageTree:Ht,PDFParser:qt,PDFParsingError:zt,PDFRadioGroup:$t,PDFRawStream:Vt,PDFRef:Wt,PDFSignature:Gt,PDFStream:Qt,PDFStreamParsingError:Kt,PDFStreamWriter:Jt,PDFString:Yt,PDFTextField:Zt,PDFTrailer:Xt,PDFTrailerDict:er,PDFWidgetAnnotation:ar,PDFWriter:tr,PDFXRefStreamParser:rr,PageEmbeddingMismatchedContextError:sr,PageSizes:or,get ParseSpeeds(){return nr},PngEmbedder:ir,get PrintScaling(){return dr},PrivateConstructorError:lr,get ReadingDirection(){return cr},RemovePageFromEmptyDocumentError:ur,ReparseError:gr,RichTextFieldReadError:pr,get RotationTypes(){return mr},StalledParserError:fr,StandardFontEmbedder:vr,StandardFontValues:br,get StandardFonts(){return be},get TextAlignment(){return xr},get TextRenderingMode(){return hr},UnbalancedParenthesisError:_r,UnexpectedFieldTypeError:yr,UnexpectedObjectTypeError:wr,UnrecognizedStreamTypeError:Pr,UnsupportedEncodingError:Dr,ViewerPreferences:Fr,adjustDimsForRotation:Sr,appendBezierCurve:Er,appendQuadraticCurve:Tr,arrayAsString:Ar,asNumber:kr,asPDFName:Ir,asPDFNumber:Lr,assertEachIs:Cr,assertInteger:Rr,assertIs:Or,assertIsOneOf:Br,assertIsOneOfOrUndefined:Nr,assertIsSubset:Ur,assertMultiple:Mr,assertOrUndefined:jr,assertPositive:Hr,assertRange:qr,assertRangeOrUndefined:zr,backtick:$r,beginMarkedContent:Vr,beginText:Wr,breakTextIntoLines:Gr,byAscendingId:Qr,bytesFor:Kr,canBeConvertedToUint8Array:Jr,charAtIndex:Yr,charFromCode:Zr,charFromHexCode:Xr,charSplit:es,cleanText:as,clip:ts,closePath:rs,cmyk:ss,colorToComponents:os,componentsToColor:ns,concatTransformationMatrix:is,copyStringIntoBuffer:ds,createPDFAcroField:ls,createPDFAcroFields:cs,createTypeErrorMsg:us,createValueErrorMsg:gs,decodeFromBase64:ps,decodeFromBase64DataUri:ms,decodePDFRawStream:fs,defaultButtonAppearanceProvider:vs,defaultCheckBoxAppearanceProvider:bs,defaultDropdownAppearanceProvider:xs,defaultOptionListAppearanceProvider:hs,defaultRadioGroupAppearanceProvider:_s,defaultTextFieldAppearanceProvider:ys,degrees:ws,degreesToRadians:Ps,drawButton:Ds,drawCheckBox:Fs,drawCheckMark:Ss,drawEllipse:Es,drawEllipsePath:Ts,drawImage:As,drawLine:ks,drawLinesOfText:Is,drawObject:Ls,drawOptionList:Cs,drawPage:Rs,drawRadioButton:Os,drawRectangle:Bs,drawSvgPath:Ns,drawTextField:Us,drawTextLines:Ms,encodeToBase64:js,endMarkedContent:Hs,endPath:qs,endText:zs,error:$s,escapeRegExp:Vs,escapedNewlineChars:Ws,fill:Gs,fillAndStroke:Qs,findLastMatch:Ks,getType:Js,grayscale:Ys,hasSurrogates:Zs,hasUtf16BOM:Xs,highSurrogate:eo,isNewlineChar:ao,isStandardFont:to,isType:ro,isWithinBMP:so,last:oo,layoutCombedText:no,layoutMultilineText:io,layoutSinglelineText:lo,lineSplit:co,lineTo:uo,lowSurrogate:go,mergeIntoTypedArray:po,mergeLines:mo,mergeUint8Arrays:fo,moveTo:vo,nextLine:bo,normalizeAppearance:xo,numberToString:ho,padStart:_o,parseDate:yo,pdfDocEncodingDecode:wo,pluckIndices:Po,popGraphicsState:Do,pushGraphicsState:Fo,radiansToDegrees:So,range:Eo,rectanglesAreEqual:To,reduceRotation:Ao,reverseArray:ko,rgb:Oe,rotateAndSkewTextRadiansAndTranslate:Io,rotateDegrees:Lo,rotateInPlace:Co,rotateRadians:Ro,rotateRectangle:Oo,scale:Bo,setDashPattern:No,setFillingCmykColor:Uo,setFillingColor:Mo,setFillingGrayscaleColor:jo,setFillingRgbColor:Ho,setFontAndSize:qo,setGraphicsState:zo,setLineCap:$o,setLineHeight:Vo,setLineWidth:Wo,setStrokingCmykColor:Go,setStrokingColor:Qo,setStrokingGrayscaleColor:Ko,setStrokingRgbColor:Jo,setTextMatrix:Yo,showText:Zo,singleQuote:Xo,sizeInBytes:en,skewRadians:an,sortedUniq:tn,stroke:rn,sum:sn,toCharCode:on,toCodePoint:nn,toDegrees:dn,toHexString:ln,toHexStringOfMinLength:cn,toRadians:un,toUint8Array:gn,translate:pn,typedArrayFor:mn,utf16Decode:fn,utf16Encode:vn,values:bn,waitForTick:xn},Symbol.toStringTag,{value:"Module"}));var Bn=E('<div class="animate-fade-in"><div class="w-16 h-16 mx-auto mb-4 rounded-2xl bg-gradient-to-br from-gov-blue to-gov-blue-dark flex items-center justify-center text-xs font-bold text-white shadow-md uppercase"> </div> <p class="text-lg font-bold text-text-primary"> </p> <p class="text-base text-text-muted mt-1"> </p> <button class="mt-3 text-sm text-gov-blue hover:text-gov-blue-dark font-medium underline underline-offset-2">Choose a different file</button></div>'),Nn=E('<div class="animate-fade-in"><div class="w-16 h-16 mx-auto mb-4 rounded-2xl bg-gray-100 flex items-center justify-center text-xs font-bold text-text-muted uppercase">File</div> <p class="text-lg font-bold text-text-primary"> </p> <p class="text-base text-text-muted mt-2 font-medium">or click to browse</p> <p class="text-xs text-text-muted mt-3">Accepted formats: .docx, .pdf</p></div>'),Un=E('<div role="button" tabindex="0" aria-label="Drop zone for file upload"><input type="file" class="hidden"/> <div class="text-center px-6 py-8"><!></div></div>');function Mn(f,a){Ne(a,!0);let u=ce(a,"accept",3,".docx,.pdf"),h=ce(a,"disabled",3,!1),b=U(!1),n=U(null),o;function g(r){if(r.preventDefault(),x(b,!1),h())return;const T=r.dataTransfer?.files[0];T&&F(T)}function y(r){r.preventDefault(),h()||x(b,!0)}function S(){x(b,!1)}function k(r){const R=r.target.files?.[0];R&&F(R)}function F(r){x(n,r,!0),a.onfileselected(r)}function p(r){return r<1024?r+" B":r<1024*1024?(r/1024).toFixed(1)+" KB":(r/(1024*1024)).toFixed(1)+" MB"}var d=Un(),l=s(d);Ln(l,r=>o=r,()=>o);var v=i(l,2),L=s(v);{var D=r=>{var T=Bn(),R=s(T),q=s(R,!0);t(R);var V=i(R,2),W=s(V,!0);t(V);var G=i(V,2),M=s(G,!0);t(G);var z=i(G,2);t(T),j((J,ue)=>{B(q,J),B(W,e(n).name),B(M,ue)},[()=>e(n).name.split(".").pop(),()=>p(e(n).size)]),oe("click",z,J=>{J.stopPropagation(),x(n,null),o.value=""}),P(r,T)},C=r=>{var T=Nn(),R=i(s(T),2),q=s(R,!0);t(R),Me(4),t(T),j(()=>B(q,e(b)?"Drop your file here!":"Drag & drop your file here")),P(r,T)};H(L,r=>{e(n)?r(D):r(C,!1)})}t(v),t(d),j(()=>{le(d,1,`relative rounded-2xl border-2 border-dashed transition-all duration-300 cursor-pointer min-h-[200px] flex items-center justify-center
		${h()?"opacity-50 cursor-not-allowed border-gray-300 bg-gray-50":""}
		${e(b)?"border-gov-blue bg-gov-blue/5 scale-[1.02] shadow-lg":"border-gray-300 hover:border-gov-blue/50 hover:bg-glass-blue"}`),Dn(l,"accept",u()),l.disabled=h()}),fe("drop",d,g),fe("dragover",d,y),fe("dragleave",d,S),oe("click",d,()=>!h()&&o.click()),oe("change",l,k),P(f,d),Ue()}Be(["click","change"]);var jn=E("<div></div>"),Hn=E('<div class="flex flex-col items-center gap-2 flex-1"><div><!></div> <span> </span></div> <!>',1),qn=E('<div class="w-full h-2 bg-gray-100 rounded-full overflow-hidden"><div class="h-full bg-gradient-to-r from-gov-blue to-gov-blue-light rounded-full transition-all duration-500"></div></div>'),zn=E('<p class="text-sm text-text-secondary mt-3 text-center font-medium"> </p>'),$n=E('<div class="glass-card-static p-6"><div class="flex items-center justify-between mb-6"></div> <!> <!></div>');function Vn(f,a){let u=ce(a,"progress",3,0),h=ce(a,"message",3,"");const b=[{phase:"transcoding",label:"Transcoding",icon:""},{phase:"compressing",label:"Compressing",icon:""},{phase:"hashing",label:"Hashing",icon:""},{phase:"stamping",label:"Stamping",icon:""},{phase:"uploading",label:"Syncing",icon:""}];function n(p){if(a.currentPhase==="error"){const v=b.findIndex(D=>D.phase===p.phase),L=b.findIndex(D=>D.phase===a.currentPhase);return v<=L?"error":"pending"}if(a.currentPhase==="done")return"done";const d=b.findIndex(v=>v.phase===a.currentPhase),l=b.findIndex(v=>v.phase===p.phase);return l<d?"done":l===d?"active":"pending"}var o=$n(),g=s(o);he(g,21,()=>b,je,(p,d,l)=>{const v=_n(()=>n(e(d)));var L=Hn(),D=hn(L),C=s(D),r=s(C);{var T=M=>{var z=xe("DONE");P(M,z)},R=M=>{var z=xe();j(()=>B(z,e(d).icon)),P(M,z)};H(r,M=>{e(v)==="done"?M(T):M(R,!1)})}t(C);var q=i(C,2),V=s(q,!0);t(q),t(D);var W=i(D,2);{var G=M=>{var z=jn();j(J=>le(z,1,`flex-shrink-0 w-8 h-0.5 mt-[-1.5rem]
					${J??""}`),[()=>n(b[l])==="done"?"bg-gov-green":"bg-gray-200"]),P(M,z)};H(W,M=>{l<b.length-1&&M(G)})}j(()=>{le(C,1,`w-12 h-12 rounded-xl flex items-center justify-center text-xl transition-all duration-300
						${e(v)==="done"?"bg-gov-green text-white shadow-md":""}
						${e(v)==="active"?"bg-gov-blue text-white shadow-lg animate-pulse-glow":""}
						${e(v)==="pending"?"bg-gray-100 text-text-muted":""}
						${e(v)==="error"?"bg-gov-red text-white":""}`),le(q,1,`text-xs font-medium text-center
					${e(v)==="active"?"text-gov-blue font-semibold":"text-text-muted"}`),B(V,e(d).label)}),P(p,L)}),t(g);var y=i(g,2);{var S=p=>{var d=qn(),l=s(d);t(d),j(()=>Fn(l,`width: ${u()??""}%`)),P(p,d)};H(y,p=>{a.currentPhase!=="done"&&a.currentPhase!=="error"&&p(S)})}var k=i(y,2);{var F=p=>{var d=zn(),l=s(d,!0);t(d),j(()=>B(l,h())),P(p,d)};H(k,p=>{h()&&p(F)})}t(o),P(f,o)}async function Wn(f){const a=f.name.split(".").pop()?.toLowerCase();if(a==="pdf"){const u=await f.arrayBuffer();return{pdfBytes:new Uint8Array(u)}}if(a==="docx"||a==="doc")return Gn(f);throw new Error(`Unsupported file type: .${a}. Only .docx and .pdf files are accepted.`)}async function Gn(f){const a=await K(()=>import("../chunks/CDQxWuWv.js").then(r=>r.i),__vite__mapDeps([0,1,2]),import.meta.url),u=await f.arrayBuffer(),h=await a.convertToHtml({arrayBuffer:u}),b=h.value,n=h.value.replace(/<[^>]*>/g," "),o=Qn(b),g=await _e.create(),y=await g.embedFont(be.Helvetica),S=await g.embedFont(be.HelveticaBold),k=595.28,F=841.89,p=50,d=11,l=d*1.5,v=k-2*p;let L=g.addPage([k,F]),D=F-p;for(const r of o){const T=r.bold?S:y,R=r.heading?14:d,q=r.heading?R*1.8:l,V=Kn(r.text,T,R,v);for(const W of V)D<p+q&&(L=g.addPage([k,F]),D=F-p),L.drawText(W,{x:p,y:D,size:R,font:T,color:Oe(.1,.1,.1)}),D-=q;D-=l*.5}return{pdfBytes:await g.save(),text:n}}function Qn(f){const a=[],u=/<(h[1-6]|p|li|tr|td|th|div|br\s*\/?)([^>]*)>([\s\S]*?)<\/\1>|<br\s*\/?>/gi;let h;const b=[];for(;(h=u.exec(f))!==null;){const o=h[1]?.toLowerCase()||"",g=h[3]||"",y=Ce(g).trim();y&&b.push({text:y,bold:/^h[1-6]$/.test(o)||/<strong|<b>/i.test(g),heading:/^h[1-6]$/.test(o)})}if(b.length>0)return b;const n=Ce(f).trim();if(n)for(const o of n.split(`
`)){const g=o.trim();g&&a.push({text:g,bold:!1,heading:!1})}return a}function Ce(f){return f.replace(/<[^>]*>/g,"").replace(/&nbsp;/g," ").replace(/&amp;/g,"&").replace(/&lt;/g,"<").replace(/&gt;/g,">").replace(/&quot;/g,'"')}function Kn(f,a,u,h){const b=f.split(" "),n=[];let o="";for(const g of b){const y=o?`${o} ${g}`:g;a.widthOfTextAtSize(y,u)>h&&o?(n.push(o),o=g):o=y}return o&&n.push(o),n.length>0?n:[""]}const Re=1024*1024;async function Jn(f,a=1024){return f.byteLength<=Re||console.warn(`[compress] File is ${(f.byteLength/1024).toFixed(0)}KB, exceeds ${Re/1024}KB target. PDF compression is limited in-browser.`),f}async function Yn(f){const a=await crypto.subtle.digest("SHA-256",f);return Array.from(new Uint8Array(a)).map(h=>h.toString(16).padStart(2,"0")).join("")}const Zn={APP_URL:Sn.PUBLIC_APP_URL||"https://v0-evision.vercel.app"};async function Xn(f,a,u=""){const h=(await K(async()=>{const{default:r}=await import("../chunks/1R2GlNHj.js").then(T=>T.b);return{default:r}},__vite__mapDeps([3,1]),import.meta.url)).default,n=`${u||Zn.APP_URL}/verify/${a}`,g=(await h.toDataURL(n,{width:100,margin:1,color:{dark:"#0038A8",light:"#FFFFFF"}})).split(",")[1],y=Uint8Array.from(atob(g),r=>r.charCodeAt(0)),S=await _e.load(f),k=await S.embedPng(y),F=S.getPages()[0],{width:p,height:d}=F.getSize(),l=72,v=30;F.drawImage(k,{x:p-l-v,y:v,width:l,height:l});const{StandardFonts:L,rgb:D}=await K(async()=>{const{StandardFonts:r,rgb:T}=await Promise.resolve().then(()=>On);return{StandardFonts:r,rgb:T}},void 0,import.meta.url),C=await S.embedFont(L.Helvetica);return F.drawText("Verify: "+a.slice(0,12)+"...",{x:p-l-v,y:v-10,size:6,font:C,color:D(.4,.4,.4)}),S.save()}function ei(f,a){const u=f;if(a){const b=new Date(a);if(b.setHours(23,59,59,999),u<=b)return"compliant";const n=new Date(b);return n.setDate(n.getDate()+1),u<=n?"late":"non-compliant"}const h=u.getDay();return h===1?"compliant":h===2?"late":"non-compliant"}async function*ai(f,a){try{yield{phase:"transcoding",progress:0,message:"Converting document to PDF..."};const u=await Wn(f),h=u.pdfBytes;yield{phase:"transcoding",progress:100,message:"Document converted"},yield{phase:"hashing",progress:0,message:"Analyzing document content..."};try{const{extractMetadata:k,parseMetadata:F}=await K(async()=>{const{extractMetadata:d,parseMetadata:l}=await import("../chunks/B5CaCgBQ.js");return{extractMetadata:d,parseMetadata:l}},__vite__mapDeps([4,5]),import.meta.url);let p;u.text?(console.log("[pipeline] Using text from Word doc for metadata extraction"),p=F(u.text)):p=await k(f),console.log("[pipeline] Metadata Result:",p),yield{phase:"hashing",progress:50,message:`Detected: ${p.docType} for Week ${p.weekNumber||"#"}`,metadata:p}}catch(k){console.warn("[pipeline] Metadata extraction failed (skipping):",k)}yield{phase:"compressing",progress:0,message:"Compressing file..."};const b=await Jn(h);yield{phase:"compressing",progress:100,message:`Compressed to ${(b.byteLength/1024).toFixed(0)}KB`},yield{phase:"hashing",progress:0,message:"Computing SHA-256 hash..."};const n=await Yn(b.buffer);if(yield{phase:"hashing",progress:100,message:`Hash: ${n.slice(0,12)}...`},navigator.onLine){const{data:k}=await Q.from("submissions").select("id").eq("file_hash",n).maybeSingle();if(k)throw new Error("Duplicate file detected. This document has already been archived.")}yield{phase:"stamping",progress:0,message:"Embedding verification QR code..."};const o=await Xn(b,n);yield{phase:"stamping",progress:100,message:"QR code stamped"},yield{phase:"uploading",progress:0,message:"Uploading to secure storage..."};const g=navigator.onLine,y=f.name.replace(/\.\w+$/,".pdf"),S=`${a.userId}/${Date.now()}_${y}`;if(g){const{error:k}=await Q.storage.from("submissions").upload(S,o,{contentType:"application/pdf",upsert:!1});if(k)throw new Error(`Upload failed: ${k.message}`);let F;if(a.calendarId){const{data:l}=await Q.from("academic_calendar").select("deadline_date").eq("id",a.calendarId).single();l?.deadline_date&&(F=new Date(l.deadline_date))}else if(a.weekNumber){const{data:l}=await Q.from("profiles").select("district_id").eq("id",a.userId).single();if(l?.district_id){const{data:v}=await Q.from("academic_calendar").select("deadline_date").eq("district_id",l.district_id).eq("week_number",a.weekNumber).maybeSingle();v?.deadline_date&&(F=new Date(v.deadline_date))}}const p=ei(new Date,F),{error:d}=await Q.from("submissions").insert({user_id:a.userId,file_name:y,file_path:S,file_hash:n,file_size:o.byteLength,doc_type:a.docType||"Unknown",week_number:a.weekNumber,subject:a.subject,school_year:a.schoolYear||"2025-2026",calendar_id:a.calendarId,teaching_load_id:a.teachingLoadId,compliance_status:p});if(d)throw console.error("[pipeline] DB insert error:",d),new Error(`Archiving failed: ${d.message}`);yield{phase:"done",progress:100,message:"Upload complete!",result:{fileHash:n,filePath:S,fileSize:o.byteLength,fileName:y}}}else await Cn({fileName:y,filePath:S,fileHash:n,fileSize:o.byteLength,pdfBytes:o,options:a,timestamp:Date.now()}),yield{phase:"done",progress:100,message:"Queued for upload — will sync when online",result:{fileHash:n,filePath:S,fileSize:o.byteLength,fileName:y}}}catch(u){const h=u instanceof Error?u.message:"Unknown error";yield{phase:"error",progress:0,message:h,error:h}}}var ti=E('<div class="mt-2 inline-flex items-center gap-2 px-3 py-1 rounded-full bg-gov-blue/5 border border-gov-blue/10 text-xs font-semibold text-gov-blue"> <!></div>'),ri=E('<div class="flex items-center gap-2 px-4 py-2 rounded-xl bg-gov-gold/10 text-gov-gold-dark text-sm font-semibold"> <button class="ml-2 px-2 py-1 bg-gov-gold text-white text-xs rounded hover:bg-gov-gold-dark transition-colors">Sync Now</button></div>'),si=E('<div class="w-full px-4 py-3 text-base bg-white/60 border border-gray-200 rounded-xl text-text-muted">Loading...</div>'),oi=E('<div class="w-full px-4 py-3 text-base bg-white/60 border border-gov-red rounded-xl text-gov-red">No teaching loads available</div>'),ni=E("<option> </option>"),ii=E('<select id="teachingLoad" class="w-full px-4 py-3 text-base bg-white/60 border border-gray-200 rounded-xl focus:ring-2 focus:ring-gov-blue/30 focus:border-gov-blue outline-none min-h-[48px]"><option>Select a teaching load...</option><!></select>'),di=E('<p class="text-[10px] text-gov-blue mt-1 font-medium animate-fade-in"> </p>'),li=E('<p class="text-[10px] text-text-muted mt-1 italic">No custom deadline set for this week.</p>'),ci=E('<div class="mt-6 p-4 bg-gov-red/10 border border-gov-red rounded-xl text-gov-red text-sm font-semibold flex items-center gap-2 animate-pulse"> </div>'),ui=E('<button class="mt-6 w-full py-4 bg-gradient-to-r from-gov-blue to-gov-blue-dark text-white text-lg font-bold rounded-xl shadow-md hover:shadow-lg hover:scale-[1.02] active:scale-[0.98] transition-all duration-300 min-h-[56px] flex items-center justify-center gap-2">Start Upload Pipeline</button>'),gi=E('<div class="glass-card-static p-6 animate-fade-in"><h3 class="text-lg font-bold text-text-primary mb-4">Document Details</h3> <div class="grid grid-cols-1 sm:grid-cols-3 gap-4"><div><label for="teachingLoad" class="block text-sm font-semibold text-text-primary mb-2">Teaching Load <span class="text-gov-red">*</span></label> <!></div> <div><label for="docType" class="block text-sm font-semibold text-text-primary mb-2">Document Type</label> <select id="docType" class="w-full px-4 py-3 text-base bg-white/60 border border-gray-200 rounded-xl focus:ring-2 focus:ring-gov-blue/30 focus:border-gov-blue outline-none min-h-[48px]"><option>Daily Lesson Log (DLL)</option><option>Instructional Supervisory Plan (ISP)</option><option>Instructional Supervisory Report (ISR)</option></select></div> <div><label for="week" class="block text-sm font-semibold text-text-primary mb-2">Week Number</label> <input id="week" type="number" placeholder="e.g., 5" min="1" max="52" class="w-full px-4 py-3 text-base bg-white/60 border border-gray-200 rounded-xl focus:ring-2 focus:ring-gov-blue/30 focus:border-gov-blue outline-none min-h-[48px]"/> <!></div></div> <!></div>'),pi=E('<div class="mb-1"><span class="text-gray-600"> </span> </div>'),mi=E('<div class="animate-pulse">_</div>'),fi=E('<div class="glass-card-static p-6 border-l-4 border-gov-green animate-fade-in"><div class="flex items-center gap-3 mb-3"><h3 class="text-lg font-bold text-gov-green">Upload Successful!</h3></div> <div class="grid grid-cols-2 gap-3 text-sm"><div><span class="text-text-muted">File:</span> <span class="font-medium text-text-primary ml-1"> </span></div> <div><span class="text-text-muted">Size:</span> <span class="font-medium text-text-primary ml-1"> </span></div> <div class="col-span-2"><span class="text-text-muted">SHA-256:</span> <code class="font-mono text-xs text-gov-blue ml-1 break-all"> </code></div></div></div>'),vi=E(`<div><div class="mb-8 flex items-start justify-between"><div><h1 class="text-2xl font-bold text-text-primary flex items-center gap-2">Upload Document <span class="text-[10px] opacity-20 font-mono font-normal">UPLOAD_PAGE_V2</span></h1> <p class="text-base text-text-secondary mt-1">Submit your DLL, ISP, or ISR for archival</p> <!></div> <!></div> <div class="grid grid-cols-1 lg:grid-cols-3 gap-8"><div class="lg:col-span-2 space-y-6"><!> <!> <div class="animate-fade-in"><!> <div class="mt-4 p-4 rounded-xl bg-gray-900 font-mono text-xs text-green-400 h-48 overflow-y-auto"><div class="mb-2 text-gray-500 border-b border-gray-800 pb-1">> Smart E-VISION PIPELINE v2.0 initialized...</div> <!> <!></div></div> <!></div> <div class="space-y-6"><div class="glass-card-static p-6"><h3 class="text-lg font-bold text-text-primary mb-4">How It Works</h3> <ol class="space-y-3 text-sm text-text-secondary"><li class="flex items-start gap-3"><span class="w-7 h-7 rounded-full bg-gov-blue/10 text-gov-blue text-xs font-bold flex items-center justify-center flex-shrink-0">1</span> <span><strong>Transcode</strong> — Word files are converted
                            to PDF</span></li> <li class="flex items-start gap-3"><span class="w-7 h-7 rounded-full bg-gov-blue/10 text-gov-blue text-xs font-bold flex items-center justify-center flex-shrink-0">2</span> <span><strong>Compress</strong> — Files are optimized to &lt;1MB</span></li> <li class="flex items-start gap-3"><span class="w-7 h-7 rounded-full bg-gov-blue/10 text-gov-blue text-xs font-bold flex items-center justify-center flex-shrink-0">3</span> <span><strong>Hash</strong> — SHA-256 fingerprint for integrity</span></li> <li class="flex items-start gap-3"><span class="w-7 h-7 rounded-full bg-gov-blue/10 text-gov-blue text-xs font-bold flex items-center justify-center flex-shrink-0">4</span> <span><strong>Stamp</strong> — Verification QR code is embedded</span></li> <li class="flex items-start gap-3"><span class="w-7 h-7 rounded-full bg-gov-blue/10 text-gov-blue text-xs font-bold flex items-center justify-center flex-shrink-0">5</span> <span><strong>Sync</strong> — Uploaded to secure cloud storage</span></li></ol></div> <div class="glass-card-static p-6 border-l-4 border-gov-gold"><h3 class="text-lg font-bold text-text-primary mb-3">Security & Integrity</h3> <p class="text-sm text-text-secondary mb-3">Your documents are secured with <strong>SHA-256</strong> digital
                    fingerprinting.</p> <ul class="space-y-2 text-xs text-text-muted"><li class="flex gap-2"><span><strong>Anti-Tampering:</strong> Any change to the file
                            content will alter its hash, making it invalid.</span></li> <li class="flex gap-2"><span><strong>No Duplicates:</strong> The system automatically
                            rejects files that have already been archived.</span></li> <li class="flex gap-2"><span><strong>Verifiable:</strong> Each document gets a unique
                            QR code for instant authenticity checks.</span></li></ul></div> <div class="glass-card-static p-6"><h3 class="text-lg font-bold text-text-primary mb-3">System Status</h3> <p class="text-sm text-text-secondary leading-relaxed">No internet? No problem. Your files are queued locally and
                    will auto-sync when your connection is restored.</p></div></div></div></div>`);function Ii(f,a){Ne(a,!0);const u=()=>kn(Rn,"$profile",h),[h,b]=In();let n=U(null),o=U("DLL"),g=U(void 0),y=U(""),S=U(ke([])),k=U(!0),F=U("transcoding"),p=U(0),d=U(""),l=U(!1),v=U(null),L=U(0),D=U(ke([])),C=U(null),r=U(!1);Ie(()=>{e(y)&&e(g)&&e(o)&&u()?T():x(r,!1)});async function T(){const{data:m,error:_}=await Q.from("submissions").select("id").eq("teaching_load_id",e(y)).eq("week_number",e(g)).eq("doc_type",e(o)).eq("school_year","2025-2026").maybeSingle();if(_){console.error("[v0] Error checking existence:",_);return}x(r,!!m)}Ie(()=>{e(g)&&u()?.district_id?R(e(g),u().district_id):x(C,null)});async function R(m,_){const{data:A}=await Q.from("academic_calendar").select("deadline_date, description").eq("district_id",_).eq("week_number",m).maybeSingle();x(C,A,!0)}yn(async()=>{if(x(L,await ve(),!0),u()){const{data:m,error:_}=await Q.from("teaching_loads").select("id, subject, grade_level").eq("user_id",u().id).eq("is_active",!0).order("subject, grade_level");_?(console.error("[v0] Error fetching teaching loads:",_.message),de("error","Failed to load teaching loads")):m&&(x(S,m,!0),e(S).length>0&&x(y,e(S)[0].id,!0));const{getWeekNumber:A}=await K(async()=>{const{getWeekNumber:O}=await import("../chunks/DmYj-g2y.js");return{getWeekNumber:O}},[],import.meta.url),c=A();u().district_id&&R(c,u().district_id)}x(k,!1)});function q(m){x(n,m,!0),x(v,null)}async function V(){if(!e(n)||!u()||!e(y)){de("error","Please select a teaching load before uploading");return}x(l,!0),x(v,null);const{speak:m,VoicePrompts:_}=await K(async()=>{const{speak:c,VoicePrompts:O}=await import("../chunks/E7PTwa2f.js");return{speak:c,VoicePrompts:O}},[],import.meta.url);m(_.UPLOAD_START);const A=ai(e(n),{userId:u().id,docType:e(o),subject:void 0,weekNumber:e(g),teachingLoadId:e(y)});x(D,[],!0);for await(const c of A){if(x(F,c.phase,!0),x(p,c.progress,!0),x(d,c.message,!0),(e(D).length===0||e(D)[e(D).length-1].message!==c.message)&&x(D,[...e(D),{timestamp:new Date().toLocaleTimeString(),message:c.message}],!0),c.metadata){c.metadata.docType!=="Unknown"&&x(o,c.metadata.docType,!0),c.metadata.weekNumber&&x(g,c.metadata.weekNumber,!0);const{speak:O}=await K(async()=>{const{speak:N}=await import("../chunks/E7PTwa2f.js");return{speak:N}},[],import.meta.url);O("Smart detection complete. Details updated.")}if(c.phase==="done"&&c.result&&(x(v,c.result,!0),m(_.UPLOAD_COMPLETE),de("success",`Document uploaded successfully! Hash: ${c.result.fileHash.slice(0,12)}...`),x(n,null)),c.phase==="error"){const{speak:O,VoicePrompts:N}=await K(async()=>{const{speak:$,VoicePrompts:Z}=await import("../chunks/E7PTwa2f.js");return{speak:$,VoicePrompts:Z}},[],import.meta.url);O(N.ERROR),de("error",c.message)}}x(l,!1),x(L,await ve(),!0)}var W=vi();En("16ciwgt",m=>{wn(()=>{Pn.title="Upload Document — Smart E-VISION"})});var G=s(W),M=s(G),z=i(s(M),4);{var J=m=>{var _=ti(),A=s(_),c=i(A);{var O=N=>{var $=xe();j(()=>B($,`· Week ${e(C).week_number??""}`)),P(N,$)};H(c,N=>{e(C).week_number&&N(O)})}t(_),j(N=>B(A,`Deadline: ${N??""} `),[()=>new Date(e(C).deadline_date).toLocaleDateString("en-PH",{month:"short",day:"numeric",year:"numeric"})]),P(m,_)};H(z,m=>{e(C)&&m(J)})}t(M);var ue=i(M,2);{var He=m=>{var _=ri(),A=s(_),c=i(A);t(_),j(()=>B(A,`${e(L)??""} file${e(L)>1?"s":""} queued offline `)),oe("click",c,async()=>{const{processQueue:O}=await K(async()=>{const{processQueue:N}=await import("../chunks/B4SNXARi.js");return{processQueue:N}},__vite__mapDeps([6,7,8,9,10]),import.meta.url);await O(!0),x(L,await ve(),!0)}),P(m,_)};H(ue,m=>{e(L)>0&&m(He)})}t(G);var ye=i(G,2),we=s(ye),Pe=s(we);Mn(Pe,{onfileselected:q,get disabled(){return e(l)}});var De=i(Pe,2);{var qe=m=>{var _=gi(),A=i(s(_),2),c=s(A),O=i(s(c),2);{var N=w=>{var I=si();P(w,I)},$=w=>{var I=oi();P(w,I)},Z=w=>{var I=ii(),Y=s(I);Y.value=Y.__value="";var me=i(Y);he(me,17,()=>e(S),re=>re.id,(re,ie)=>{var se=ni(),Xe=s(se);t(se);var Ae={};j(()=>{B(Xe,`${e(ie).subject??""} - Grade ${e(ie).grade_level??""}`),Ae!==(Ae=e(ie).id)&&(se.value=(se.__value=e(ie).id)??"")}),P(re,se)}),t(I),Le(I,()=>e(y),re=>x(y,re)),P(w,I)};H(O,w=>{e(k)?w(N):e(S).length===0?w($,1):w(Z,!1)})}t(c);var ae=i(c,2),X=i(s(ae),2),ee=s(X);ee.value=ee.__value="DLL";var te=i(ee);te.value=te.__value="ISP";var ne=i(te);ne.value=ne.__value="ISR",t(X),t(ae);var Te=i(ae,2),pe=i(s(Te),2);Tn(pe);var Ge=i(pe,2);{var Qe=w=>{var I=di(),Y=s(I);t(I),j(me=>B(Y,`Target Deadline: ${me??""}`),[()=>new Date(e(C).deadline_date).toLocaleDateString()]),P(w,I)},Ke=w=>{var I=li();P(w,I)};H(Ge,w=>{e(C)?w(Qe):e(g)&&w(Ke,1)})}t(Te),t(A);var Je=i(A,2);{var Ye=w=>{var I=ci(),Y=s(I);t(I),j(()=>B(Y,`A ${e(o)??""} has already been submitted for this load
                            and week.`)),P(w,I)},Ze=w=>{var I=ui();oe("click",I,V),P(w,I)};H(Je,w=>{e(r)?w(Ye):w(Ze,!1)})}t(_),Le(X,()=>e(o),w=>x(o,w)),An(pe,()=>e(g),w=>x(g,w)),P(m,_)};H(De,m=>{e(n)&&!e(l)&&m(qe)})}var ge=i(De,2),Fe=s(ge);Vn(Fe,{get currentPhase(){return e(F)},get progress(){return e(p)},get message(){return e(d)}});var Se=i(Fe,2),Ee=i(s(Se),2);he(Ee,17,()=>e(D),je,(m,_)=>{var A=pi(),c=s(A),O=s(c);t(c);var N=i(c);t(A),j(()=>{B(O,`[${e(_).timestamp??""}]`),B(N,` ${e(_).message??""}`)}),P(m,A)});var ze=i(Ee,2);{var $e=m=>{var _=mi();P(m,_)};H(ze,m=>{e(F)!=="done"&&e(F)!=="error"&&m($e)})}t(Se),t(ge);var Ve=i(ge,2);{var We=m=>{var _=fi(),A=i(s(_),2),c=s(A),O=i(s(c),2),N=s(O,!0);t(O),t(c);var $=i(c,2),Z=i(s($),2),ae=s(Z);t(Z),t($);var X=i($,2),ee=i(s(X),2),te=s(ee,!0);t(ee),t(X),t(A),t(_),j(ne=>{B(N,e(v).fileName),B(ae,`${ne??""} KB`),B(te,e(v).fileHash)},[()=>(e(v).fileSize/1024).toFixed(0)]),P(m,_)};H(Ve,m=>{e(v)&&m(We)})}t(we),Me(2),t(ye),t(W),P(f,W),Ue(),b()}Be(["click"]);export{Ii as component};
