function f(e){let t=0,o=0,l=0;for(const n of e){const a=(n.compliance_status||"non-compliant").toLowerCase().trim();a==="compliant"||a==="on-time"?t++:a==="late"?o++:l++}return{compliant:t,late:o,nonCompliant:l,total:t+o+l}}function p(e,t=0,o,l){const n=f(e),a=n.total,c=a>0?Math.min(100,Math.round(n.compliant/a*100)):0;return{Compliant:n.compliant,Late:n.late,NonCompliant:n.nonCompliant,totalUploaded:a,expected:o!==void 0?o:t,rate:c}}const g=new Date("2025-08-01");function s(e=new Date){const t=e.getTime()-g.getTime(),o=Math.ceil(t/(1e3*60*60*24*7));return Math.max(1,o)}function w(e){return e>=80?"text-gov-green":e>=50?"text-gov-gold-dark":"text-gov-red"}function k(e){return e>=80?"bg-gov-green/15":e>=50?"bg-gov-gold/15":"bg-gov-red/15"}function b(e){if(!e)return"non-compliant";const t=e.toLowerCase().trim();return t==="compliant"||t==="on-time"?"compliant":t==="late"?"late":t==="non-compliant"||t==="missing"||t==="non compliant"?"non-compliant":t}function C(e,t=0,o=8,l=[]){const n=[];if(l.length>0){const c=[...l].sort((r,u)=>u.week_number-r.week_number).slice(0,o);for(const r of c){const u=e.filter(m=>m.week_number===r.week_number),i=p(u,t);n.push({week:r.week_number,label:`W${r.week_number}`,Compliant:i.Compliant,Late:i.Late,NonCompliant:i.NonCompliant,rate:i.rate,docs:u.length})}return n.reverse()}const a=s();for(let c=o-1;c>=0;c--){const r=a-c;if(r<1)continue;const u=e.filter(m=>m.week_number?m.week_number===r:s(new Date(m.created_at))===r),i=p(u,t);n.push({week:r,label:`W${r}`,Compliant:i.Compliant,Late:i.Late,NonCompliant:i.NonCompliant,rate:i.rate,docs:u.length})}return n}function _(e){return e.week_number?e.week_number:e.created_at?s(new Date(e.created_at)):s()}export{p as calculateCompliance,f as countSubmissionsByStatus,k as getComplianceBgClass,w as getComplianceClass,_ as getSubmissionWeek,s as getWeekNumber,C as groupSubmissionsByWeek,b as normalizeComplianceStatus};
